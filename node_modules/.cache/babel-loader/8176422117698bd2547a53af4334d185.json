{"ast":null,"code":"var _jsxFileName = \"/home/jonathan/Documentos/cefet-web-tp/client/src/componentes/World/components/widgets/gallery/Gallery.js\";\nimport React, { Component } from 'react';\nimport './gallery.css';\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\nimport { Carousel } from 'react-responsive-carousel';\nimport axios from 'axios';\nimport { uploadImage } from '../../../../WorldFunctions';\nimport { getAllImages } from '../../../../WorldFunctions';\nimport ImageUploader from 'react-images-upload';\n\nconst jwt = require(\"jsonwebtoken\");\n\nconst userId = window.location.href.split('World')[1];\nconsole.log(localStorage);\nconsole.log(jwt.decode(localStorage.usertoken));\nconst userLogado = (localStorage.usertoken || jwt.decode(localStorage.usertoken)) == null ? jwt.decode(localStorage.usertoken).id : -1;\nconst editavel = userId == userLogado ? true : false;\n\nconst image2base64 = require('image-to-base64');\n\nvar base64ToImage = require('base64-to-image');\n\nvar urls = [];\n\nclass Gallery extends Component {\n  constructor(props) {\n    super(props);\n\n    this.fileSelectedHandler = event => {\n      this.setState({\n        selectedFile: URL.createObjectURL(event.target.files[0])\n      });\n      console.log(\"TESTE DA  BUSCA DE IMAGENS\");\n      console.log(this.img);\n      let type = event.target.files[0].type;\n      image2base64(URL.createObjectURL(event.target.files[0])).then(response => {\n        console.log(\"TESTE\");\n        this.state.base64 = \"data:\" + type + \";base64,\" + response; //var imageInfo = base64ToImage( this.state.base64,\"../../../../static\",null); \n        //console.log(\"IMAGEM INFO = \" + imageInfo)\n      }).catch(error => {\n        console.log(error); //Exepection error....\n      });\n    };\n\n    this.fileUploadHandler = () => {\n      const image = {\n        base64: this.state.base64,\n        id_user: userId\n      };\n\n      if (editavel) {\n        uploadImage(image).then(res => {\n          console.log(\"UPLOAD\");\n        });\n      }\n\n      this.findAllImage();\n      this.forceUpdate();\n    };\n\n    this.findAllImage = () => {\n      const user = {\n        id_user: userId\n      };\n      getAllImages(user).then(res => {\n        console.log(\"Imagens buscadas\");\n        this.img = res;\n        console.log(this.img);\n\n        if (res.data.length == 0) {\n          urls.push('../../../../../static/fav.ico.png');\n        } else {\n          for (var i = 0; i < this.img.data.length; i++) {\n            urls.push(this.img.data[i].base64);\n          }\n        }\n\n        this.forceUpdate();\n      });\n    };\n\n    var img;\n    this.findAllImage();\n    this.state = {\n      isOpen: {},\n      selectedFile: null,\n      base64: null,\n      images: null\n    };\n  }\n\n  renderRow(row) {\n    return React.createElement(\"div\", {\n      className: \"gallery-div\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      src: row,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 36\n      },\n      __self: this\n    }), \">\");\n  }\n\n  tempo(milliseconds) {\n    var start = new Date().getTime();\n\n    for (var i = 0; i < 1e7; i++) {\n      if (new Date().getTime() - start > milliseconds) {\n        break;\n      }\n    }\n  }\n\n  componentDidMount() {}\n\n  render() {\n    console.log(\"NO RENDER\");\n    console.log(urls);\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 123\n      },\n      __self: this\n    }, React.createElement(\"input\", {\n      type: \"file\",\n      id: \"file\",\n      onChange: this.fileSelectedHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }), React.createElement(\"button\", {\n      onClick: this.fileUploadHandler,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, \"Upload\"), React.createElement(Carousel, {\n      className: \"gallery-dimension\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, urls.map(this.renderRow)));\n  }\n\n}\n\nexport default Gallery;","map":{"version":3,"sources":["/home/jonathan/Documentos/cefet-web-tp/client/src/componentes/World/components/widgets/gallery/Gallery.js"],"names":["React","Component","Carousel","axios","uploadImage","getAllImages","ImageUploader","jwt","require","userId","window","location","href","split","console","log","localStorage","decode","usertoken","userLogado","id","editavel","image2base64","base64ToImage","urls","Gallery","constructor","props","fileSelectedHandler","event","setState","selectedFile","URL","createObjectURL","target","files","img","type","then","response","state","base64","catch","error","fileUploadHandler","image","id_user","res","findAllImage","forceUpdate","user","data","length","push","i","isOpen","images","renderRow","row","tempo","milliseconds","start","Date","getTime","componentDidMount","render","map"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n\nimport './gallery.css'\nimport \"react-responsive-carousel/lib/styles/carousel.min.css\";\nimport { Carousel } from 'react-responsive-carousel';\nimport axios from 'axios';\nimport { uploadImage } from '../../../../WorldFunctions'\nimport { getAllImages } from '../../../../WorldFunctions'\nimport ImageUploader from 'react-images-upload';\nconst jwt = require(\"jsonwebtoken\")\nconst userId = window.location.href.split('World')[1]\nconsole.log(localStorage)\nconsole.log(jwt.decode(localStorage.usertoken))\nconst userLogado = (localStorage.usertoken || jwt.decode(localStorage.usertoken)) == null ? jwt.decode(localStorage.usertoken).id : -1;\nconst editavel = userId == userLogado ? true : false;\n\nconst image2base64 = require('image-to-base64');\nvar base64ToImage = require('base64-to-image');\nvar urls = [];\nclass Gallery extends Component {\n\n  constructor(props) {\n    super(props)\n    var img;\n    this.findAllImage();\n    this.state = {\n      isOpen: {},\n      selectedFile: null,\n      base64: null,\n      images: null\n    }\n\n  }\n\n  renderRow(row) {\n    return (<div className=\"gallery-div\" ><img src={row}></img>></div>)\n  }\n\n\n  tempo(milliseconds) {\n    var start = new Date().getTime();\n    for (var i = 0; i < 1e7; i++) {\n      if ((new Date().getTime() - start) > milliseconds) {\n        break;\n      }\n    }\n  }\n  fileSelectedHandler = event => {\n    this.setState({\n      selectedFile: URL.createObjectURL(event.target.files[0])\n    })\n    console.log(\"TESTE DA  BUSCA DE IMAGENS\")\n    console.log(this.img)\n    let type = event.target.files[0].type;\n\n    image2base64(URL.createObjectURL(event.target.files[0]))\n      .then(\n        (response) => {\n          console.log(\"TESTE\")\n          this.state.base64 = \"data:\" + type + \";base64,\" + response;\n          //var imageInfo = base64ToImage( this.state.base64,\"../../../../static\",null); \n          //console.log(\"IMAGEM INFO = \" + imageInfo)\n        }\n      )\n      .catch(\n        (error) => {\n          console.log(error); //Exepection error....\n        }\n      )\n\n  }\n  fileUploadHandler = () => {\n    const image = {\n      base64: this.state.base64,\n      id_user: userId\n    }\n    if (editavel) {\n      uploadImage(image)\n        .then(res => {\n          console.log(\"UPLOAD\")\n        })\n    }\n\n\n    this.findAllImage()\n    this.forceUpdate();\n  }\n\n  findAllImage = () => {\n\n    const user = {\n      id_user: userId\n    }\n    getAllImages(user).then(res => {\n      console.log(\"Imagens buscadas\")\n      this.img = res\n      console.log(this.img)\n\n      if (res.data.length == 0) {\n        urls.push('../../../../../static/fav.ico.png')\n      } else {\n        for (var i = 0; i < this.img.data.length; i++) {\n          urls.push(this.img.data[i].base64)\n        }\n      }\n      this.forceUpdate();\n    })\n\n  }\n\n  componentDidMount() {\n\n\n  }\n\n  render() {\n\n    console.log(\"NO RENDER\")\n    console.log(urls)\n\n    return (\n\n      <div >\n        <input type=\"file\" id=\"file\" onChange={this.fileSelectedHandler}></input>\n        <button onClick={this.fileUploadHandler}>Upload</button>\n        <Carousel className=\"gallery-dimension\">\n          {urls.map(this.renderRow)}\n        </Carousel>\n      </div>\n\n    )\n  }\n}\n\nexport default Gallery"]},"metadata":{},"sourceType":"module"}